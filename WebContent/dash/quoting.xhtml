<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Quoting</title>
	<ui:include src="/_includes/_dashboard_header" />
</h:head>
<h:body>
	<p:layout fullPage="true">
		<p:layoutUnit position="north" size="62"
			styleClass="q-dashboard-background" id="north">
			<ui:include src="/_includes/top_dashboard" />
		</p:layoutUnit>
		<ui:include src="/_includes/side" />
		<p:layoutUnit position="center">
			<h:form id="form-g">
				<p:growl id="error-growl" sticky="true"
					rendered="#{facesContext.maximumSeverity.ordinal eq 2}" />
				<p:growl id="success-growl" sticky="true"
					rendered="#{facesContext.maximumSeverity.ordinal eq 0}" />
			</h:form>
			<div align="center">
				<h:outputText value="Quoting" styleClass="q-large-text" />
			</div>

			<div class="w3-container">
				<div class="w3-row">
					<ui:repeat var="cart" value="#{quotingBean.carts}">
						<div class="w3-container">
							<div class="w3-card-4">
								<header class="w3-container w3-green w3-text-light-grey">
								<br />
								<div align="center" class="q-med-text">
									<h:outputText value="Cart# #{cart.id}" />
								</div>
								<div class="w3-row">
									<div class="w3-half q-bold" align="left">
										<h:outputText value="#{cart.modelYear.fullName}" />
									</div>
									<div class="w3-half q-bold" align="right">
										<h:outputText value="#{cart.vin}" />
									</div>
								</div>
								<br />
								</header>
								<div class="w3-container">
									<br />
									<h:form>
										<h:dataTable value="#{cart.waitingQuotationItems}" var="qi"
											styleClass="w3-table w3-striped w3-border"
											headerClass="w3-light-grey w3-border-bottom"
											footerClass="w3-light-grey w3-border-top">
											<h:column>
												<f:facet name="header">
													<h:outputText value="Edit" />
												</f:facet>
												<h:selectBooleanCheckbox value="#{qi.edit}"
													disabled="#{qi.notAvailable}">
													<f:ajax render="@form" execute="@this" />
												</h:selectBooleanCheckbox>

											</h:column>
											<h:column>
												<f:facet name="header">
													<h:outputText value="Description" />
												</f:facet>
												<h:outputText value="#{qi.itemDesc}"
													rendered="#{not qi.edit}" />
												<h:inputText value="#{qi.itemDesc}" size="10"
													rendered="#{qi.edit and not (qi.notAvailable)}">
													<f:ajax execute="@this" />
												</h:inputText>
											</h:column>
											<h:column>
												<f:facet name="header">
													<h:outputText value="Part Number" />
												</f:facet>
												<h:inputText value="#{qi.itemDescAr}" size="10"
													rendered="#{qi.product eq null and not (qi.notAvailable)}" />
												<h:outputText value="#{qi.product.productNumber}"
													rendered="#{not (qi.product eq null)}" />
											</h:column>
											<h:column>
												<f:facet name="header">
													<h:outputText value="Qty." />
												</f:facet>
												<h:outputText value="#{qi.quantity}"
													rendered="#{not qi.edit}" />
												<h:selectOneMenu value="#{qi.quantity}"
													rendered="#{qi.edit and not (qi.notAvailable)}">
													<f:selectItem itemValue="#{1}" />
													<f:selectItem itemValue="#{2}" />
													<f:selectItem itemValue="#{3}" />
													<f:selectItem itemValue="#{4}" />
													<f:selectItem itemValue="#{5}" />
													<f:selectItem itemValue="#{6}" />
													<f:selectItem itemValue="#{7}" />
													<f:selectItem itemValue="#{8}" />
													<f:selectItem itemValue="#{9}" />
													<f:selectItem itemValue="#{10}" />
													<f:selectItem itemValue="#{11}" />
													<f:selectItem itemValue="#{12}" />
													<f:selectItem itemValue="#{13}" />
													<f:selectItem itemValue="#{14}" />
													<f:selectItem itemValue="#{15}" />
													<f:selectItem itemValue="#{16}" />
													<f:selectItem itemValue="#{17}" />
													<f:selectItem itemValue="#{18}" />
													<f:selectItem itemValue="#{19}" />
													<f:selectItem itemValue="#{20}" />
													<f:ajax render="@form" execute="@this" />
												</h:selectOneMenu>
											</h:column>
											<h:column>
												<f:facet name="header">
													<h:outputText value="Vendor" />
												</f:facet>
												<h:outputText
													value="#{vendorBean.getVendorFromId(qi.product.selectedPrice.vendorId).name}"
													rendered="#{not (qi.product eq null) and not (qi.product.selectedPrice eq null) and not (qi.edit)}">
													<f:convertNumber currencySymbol="SR " type="currency" />
												</h:outputText>
												<h:selectOneMenu value="#{qi.product.selectedPriceId}"
													rendered="#{not (qi.product eq null) and not (qi.product.selectedPrice eq null) and (qi.edit)}">
													<f:selectItems value="#{qi.product.priceList}" var="pr"
														itemValue="#{pr.id}"
														itemLabel="#{vendorBean.getVendorFromId(pr.vendorId).name}" />
													<f:ajax render="@form" execute="@this"
														listener="#{qi.product.resetSelectedPriceListFromSelectedId()}" />
												</h:selectOneMenu>
											</h:column>
											<h:column>
												<f:facet name="header">
													<h:outputText value="Price" />
												</f:facet>
												<h:outputText value="#{qi.product.selectedPrice.costPrice}"
													rendered="#{not (qi.product eq null) and not (qi.product.selectedPrice eq null)}">
													<f:convertNumber currencySymbol="SR " type="currency" />
												</h:outputText>
											</h:column>
											<h:column>
												<f:facet name="header">
													<div align="center">
														<h:outputText value="Not Available" />
													</div>
												</f:facet>
												<div align="center">
													<h:selectBooleanCheckbox value="#{qi.notAvailable}">
														<f:ajax render="@form" execute="@this"
															listener="#{qi.setEdit(false)}" />
													</h:selectBooleanCheckbox>
												</div>
											</h:column>
											<h:column>
												<f:facet name="header">
												<div align="center">
													<h:outputText value="Submit" />
													</div>
												</f:facet>
												<div align="center">
													<p:commandButton value="Submit" styleClass="q-btn"></p:commandButton>
												</div>
											</h:column>
											<f:facet name="footer">
												<div class="w3-row">
													<div align="left" class="w3-half">
														<p:commandButton value="Find"
															actionListener="#{quotingBean.findProducts(cart)}"
															process="@form" update="@form :form-g" styleClass="q-btn">
														</p:commandButton>
													</div>
													<div align="right" class="w3-half">
														<p:commandButton value="+"
															actionListener="#{quotingBean.initQoutationItem(cart)}"
															styleClass="q-btn" process="@this" update="@form">
														</p:commandButton>
													</div>

												</div>
											</f:facet>
										</h:dataTable>
										<div align="center" class="w3-padding-12">
											<p:commandButton value="Submit All" styleClass="q-btn"
												actionListener="#{quotingBean.submitQuote(cart)}"></p:commandButton>
										</div>
									</h:form>
								</div>
							</div>
							<br /> <br />
						</div>
					</ui:repeat>
				</div>
			</div>
		</p:layoutUnit>
	</p:layout>
</h:body>
</html>
